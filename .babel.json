{
  "{\"filename\":\"/app/app.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/app\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.18.0": {
    "metadata": {
      "usedHelpers": [
        "interopRequireDefault"
      ],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "mz/fs",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "fs"
              }
            ]
          },
          {
            "source": "express",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Express"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/app/app.js",
      "filenameRelative": "/app/app.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "app.js",
      "sourceFileName": "app.js",
      "sourceRoot": "/app",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/app",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "app"
    },
    "ignored": false,
    "code": "'use strict';\n\nvar _fs = require('mz/fs');\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _express = require('express');\n\nvar _express2 = _interopRequireDefault(_express);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBOzs7O0FBQ0EiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlUm9vdCI6Ii9hcHAiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZnMgZnJvbSAnbXovZnMnXG5pbXBvcnQgRXhwcmVzcyBmcm9tICdleHByZXNzJyJdfQ==",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "app.js"
      ],
      "names": [],
      "mappings": ";;AAAA;;;;AACA",
      "file": "app.js",
      "sourceRoot": "/app",
      "sourcesContent": [
        "import fs from 'mz/fs'\nimport Express from 'express'"
      ]
    },
    "mtime": 1487035495800
  },
  "{\"filename\":\"/app/app.js\",\"env\":{},\"retainLines\":false,\"highlightCode\":true,\"suppressDeprecationMessages\":false,\"presets\":[],\"plugins\":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{\"loose\":false,\"spec\":false}],[[],null],[[],null],[[],{\"spec\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"loose\":false}],[[],null],[[],null],[[],null],[[],{\"loose\":false}],[[],null],[[],{\"loose\":false}],[[],null],[[],null],[[],{\"loose\":false}],[[],{\"async\":false,\"asyncGenerators\":false}]],\"ignore\":[],\"code\":true,\"metadata\":true,\"ast\":true,\"comments\":true,\"compact\":\"auto\",\"minified\":false,\"sourceRoot\":\"/app\",\"babelrc\":true,\"sourceType\":\"module\",\"moduleIds\":false,\"passPerPreset\":false,\"parserOpts\":false,\"generatorOpts\":false}:6.23.0": {
    "metadata": {
      "usedHelpers": [
        "interopRequireDefault"
      ],
      "marked": [],
      "modules": {
        "imports": [
          {
            "source": "express",
            "imported": [
              "default"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Express"
              }
            ]
          },
          {
            "source": "isomorphic-fetch",
            "imported": [],
            "specifiers": []
          },
          {
            "source": "unsplash-js",
            "imported": [
              "default",
              "toJson"
            ],
            "specifiers": [
              {
                "kind": "named",
                "imported": "default",
                "local": "Unsplash"
              },
              {
                "kind": "named",
                "imported": "toJson",
                "local": "toJson"
              }
            ]
          }
        ],
        "exports": {
          "exported": [],
          "specifiers": []
        }
      }
    },
    "options": {
      "filename": "/app/app.js",
      "filenameRelative": "/app/app.js",
      "env": {},
      "retainLines": false,
      "highlightCode": true,
      "suppressDeprecationMessages": false,
      "presets": [],
      "plugins": [
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false,
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "spec": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          null
        ],
        [
          [],
          null
        ],
        [
          [],
          {
            "loose": false
          }
        ],
        [
          [],
          {
            "async": false,
            "asyncGenerators": false
          }
        ]
      ],
      "ignore": [],
      "code": true,
      "metadata": true,
      "ast": false,
      "comments": true,
      "compact": "auto",
      "minified": false,
      "sourceMaps": "both",
      "sourceMapTarget": "app.js",
      "sourceFileName": "app.js",
      "sourceRoot": "/app",
      "babelrc": false,
      "sourceType": "module",
      "moduleRoot": "/app",
      "moduleIds": false,
      "passPerPreset": false,
      "parserOpts": false,
      "generatorOpts": false,
      "basename": "app"
    },
    "ignored": false,
    "code": "'use strict';\n\nvar _express = require('express');\n\nvar _express2 = _interopRequireDefault(_express);\n\nrequire('isomorphic-fetch');\n\nvar _unsplashJs = require('unsplash-js');\n\nvar _unsplashJs2 = _interopRequireDefault(_unsplashJs);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar unsplash = new _unsplashJs2.default({\n  applicationId: process.env.applicationId,\n  secret: process.env.secret,\n  callbackUrl: process.env.callbackUrl\n});\n\nvar app = (0, _express2.default)();\nvar latest = [{ 'date': Date.now() }];\n\nfunction updateLatest(query, offset, results) {\n  if (latest.length == 10) latest.shift();\n  latest.push({\n    'query': query,\n    'offset': offset,\n    'results': results,\n    'date': Date.now()\n  });\n  console.log(latest);\n}\n\n// enable CORS\napp.use(function (req, res, next) {\n  res.header(\"Access-Control-Allow-Origin\", \"*\");\n  res.header(\"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Accept\");\n  next();\n});\n\napp.get('/', function (req, res) {\n  res.send('Need help?</br><a href=\"https://github.com/IsaacAbrahamson/image-abstraction\" target=\"_blank\">Visit Repository</a>');\n});\n\napp.get('/api/latest', function (req, res) {\n  return res.json(latest);\n});\n\napp.get('/api/search/:photo', function (req, res) {\n  var query = req.params.photo;\n  var offset = req.query.offset || 1;\n  var results = req.query.results || 5;\n\n  unsplash.search.photos(query, offset, results).then(_unsplashJs.toJson).then(function (json) {\n    if (offset > json.total_pages) {\n      var error = new Error();\n      error.stack = 'Offset (' + offset + ') exceeds number of pages available (' + json.total_pages + ')';\n      throw error;\n    }\n\n    var photos = [];\n    var _iteratorNormalCompletion = true;\n    var _didIteratorError = false;\n    var _iteratorError = undefined;\n\n    try {\n      for (var _iterator = json.results[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n        var photo = _step.value;\n\n        photos.push({\n          photographer: photo.user.name + ' | Unsplash',\n          raw: photo.urls.raw,\n          full: photo.urls.full,\n          regular: photo.urls.regular,\n          small: photo.urls.small,\n          thumbnail: photo.urls.thumb,\n          alt: query + ' photo by ' + photo.user.name + ' courtesy of Unsplash'\n        });\n      }\n    } catch (err) {\n      _didIteratorError = true;\n      _iteratorError = err;\n    } finally {\n      try {\n        if (!_iteratorNormalCompletion && _iterator.return) {\n          _iterator.return();\n        }\n      } finally {\n        if (_didIteratorError) {\n          throw _iteratorError;\n        }\n      }\n    }\n\n    res.json({ \"Total Pages\": json.total_pages, photos: photos });\n    updateLatest(query, offset, results);\n  }).catch(function (err) {\n    if (err.stack) res.json({ error: err.stack });else res.json({ err: 'An error occured.' });\n  });\n});\n\napp.listen(process.env.PORT);\nconsole.log('listening on port ' + process.env.PORT + '...');\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJ1bnNwbGFzaCIsImFwcGxpY2F0aW9uSWQiLCJwcm9jZXNzIiwiZW52Iiwic2VjcmV0IiwiY2FsbGJhY2tVcmwiLCJhcHAiLCJsYXRlc3QiLCJEYXRlIiwibm93IiwidXBkYXRlTGF0ZXN0IiwicXVlcnkiLCJvZmZzZXQiLCJyZXN1bHRzIiwibGVuZ3RoIiwic2hpZnQiLCJwdXNoIiwiY29uc29sZSIsImxvZyIsInVzZSIsInJlcSIsInJlcyIsIm5leHQiLCJoZWFkZXIiLCJnZXQiLCJzZW5kIiwianNvbiIsInBhcmFtcyIsInBob3RvIiwic2VhcmNoIiwicGhvdG9zIiwidGhlbiIsInRvdGFsX3BhZ2VzIiwiZXJyb3IiLCJFcnJvciIsInN0YWNrIiwicGhvdG9ncmFwaGVyIiwidXNlciIsIm5hbWUiLCJyYXciLCJ1cmxzIiwiZnVsbCIsInJlZ3VsYXIiLCJzbWFsbCIsInRodW1ibmFpbCIsInRodW1iIiwiYWx0IiwiY2F0Y2giLCJlcnIiLCJsaXN0ZW4iLCJQT1JUIl0sIm1hcHBpbmdzIjoiOztBQUFBOzs7O0FBQ0E7O0FBQ0E7Ozs7OztBQUVBLElBQU1BLFdBQVcseUJBQWE7QUFDNUJDLGlCQUFlQyxRQUFRQyxHQUFSLENBQVlGLGFBREM7QUFFNUJHLFVBQVFGLFFBQVFDLEdBQVIsQ0FBWUMsTUFGUTtBQUc1QkMsZUFBYUgsUUFBUUMsR0FBUixDQUFZRTtBQUhHLENBQWIsQ0FBakI7O0FBTUEsSUFBTUMsTUFBTSx3QkFBWjtBQUNBLElBQU1DLFNBQVMsQ0FBQyxFQUFDLFFBQVFDLEtBQUtDLEdBQUwsRUFBVCxFQUFELENBQWY7O0FBRUEsU0FBU0MsWUFBVCxDQUFzQkMsS0FBdEIsRUFBNkJDLE1BQTdCLEVBQXFDQyxPQUFyQyxFQUE4QztBQUM1QyxNQUFJTixPQUFPTyxNQUFQLElBQWlCLEVBQXJCLEVBQXlCUCxPQUFPUSxLQUFQO0FBQ3pCUixTQUFPUyxJQUFQLENBQVk7QUFDVixhQUFTTCxLQURDO0FBRVYsY0FBVUMs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anMiLCJzb3VyY2VSb290IjoiL2FwcCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBFeHByZXNzIGZyb20gJ2V4cHJlc3MnXG5pbXBvcnQgJ2lzb21vcnBoaWMtZmV0Y2gnXG5pbXBvcnQgVW5zcGxhc2gsIHsgdG9Kc29uIH0gZnJvbSAndW5zcGxhc2gtanMnXG5cbmNvbnN0IHVuc3BsYXNoID0gbmV3IFVuc3BsYXNoKHtcbiAgYXBwbGljYXRpb25JZDogcHJvY2Vzcy5lbnYuYXBwbGljYXRpb25JZCxcbiAgc2VjcmV0OiBwcm9jZXNzLmVudi5zZWNyZXQsXG4gIGNhbGxiYWNrVXJsOiBwcm9jZXNzLmVudi5jYWxsYmFja1VybFxufSlcblxuY29uc3QgYXBwID0gRXhwcmVzcygpXG5jb25zdCBsYXRlc3QgPSBbeydkYXRlJzogRGF0ZS5ub3coKX1dXG5cbmZ1bmN0aW9uIHVwZGF0ZUxhdGVzdChxdWVyeSwgb2Zmc2V0LCByZXN1bHRzKSB7XG4gIGlmIChsYXRlc3QubGVuZ3RoID09IDEwKSBsYXRlc3Quc2hpZnQoKVxuICBsYXRlc3QucHVzaCh7XG4gICAgJ3F1ZXJ5JzogcXVlcnksXG4gICAgJ29mZnNldCc6IG9mZnNldCxcbiAgICAncmVzdWx0cyc6IHJlc3VsdHMsXG4gICAgJ2RhdGUnOiBEYXRlLm5vdygpXG4gIH0pXG4gIGNvbnNvbGUubG9nKGxhdGVzdClcbn1cblxuLy8gZW5hYmxlIENPUlNcbmFwcC51c2UoKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIHJlcy5oZWFkZXIoXCJBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW5cIiwgXCIqXCIpO1xuICByZXMuaGVhZGVyKFwiQWNjZXNzLUNvbnRyb2wtQWxsb3ctSGVhZGVyc1wiLCBcIk9yaWdpbiwgWC1SZXF1ZXN0ZWQtV2l0aCwgQ29udGVudC1UeXBlLCBBY2NlcHRcIik7XG4gIG5leHQoKVxufSlcblxuYXBwLmdldCgnLycsIChyZXEsIHJlcykgPT4ge1xuICByZXMuc2VuZCgnTmVlZCBoZWxwPzwvYnI+PGEgaHJlZj1cImh0dHBzOi8vZ2l0aHViLmNvbS9Jc2FhY0FicmFoYW1zb24vaW1hZ2UtYWJzdHJhY3Rpb25cIiB0YXJnZXQ9XCJfYmxhbmtcIj5WaXNpdCBSZXBvc2l0b3J5PC9hPicpXG59KVxuXG5hcHAuZ2V0KCcvYXBpL2xhdGVzdCcsIChyZXEsIHJlcykgPT4gcmVzLmpzb24obGF0ZXN0KSlcblxuYXBwLmdldCgnL2FwaS9zZWFyY2gvOnBob3RvJywgKHJlcSwgcmVzKSA9PiB7XG4gIHZhciBxdWVyeSA9IHJlcS5wYXJhbXMucGhvdG9cbiAgdmFyIG9mZnNldCA9IHJlcS5xdWVyeS5vZmZzZXQgfHwgMVxuICB2YXIgcmVzdWx0cyA9IHJlcS5xdWVyeS5yZXN1bHRzIHx8IDVcbiAgXG4gIHVuc3BsYXNoLnNlYXJjaC5waG90b3MocXVlcnksIG9mZnNldCwgcmVzdWx0cylcbiAgLnRoZW4odG9Kc29uKVxuICAudGhlbihqc29uID0+IHtcbiAgICBpZiAob2Zmc2V0ID4ganNvbi50b3RhbF9wYWdlcykge1xuICAgICAgdmFyIGVycm9yID0gbmV3IEVycm9yKClcbiAgICAgIGVycm9yLnN0YWNrID0gYE9mZnNldCAoJHtvZmZzZXR9KSBleGNlZWRzIG51bWJlciBvZiBwYWdlcyBhdmFpbGFibGUgKCR7anNvbi50b3RhbF9wYWdlc30pYFxuICAgICAgdGhyb3cgZXJyb3JcbiAgICB9XG4gICAgXG4gICAgdmFyIHBob3RvcyA9IFtdICAgIFxuICAgIGZvciAodmFyIHBob3RvIG9mIGpzb24ucmVzdWx0cykgeyAgICAgXG4gICAgICBwaG90b3MucHVzaCh7XG4gICAgICAgIHBob3RvZ3JhcGhlcjogcGhvdG8udXNlci5uYW1lICsgJyB8IFVuc3BsYXNoJyxcbiAgICAgICAgcmF3OiBwaG90by51cmxzLnJhdyxcbiAgICAgICAgZnVsbDogcGhvdG8udXJscy5mdWxsLFxuICAgICAgICByZWd1bGFyOiBwaG90by51cmxzLnJlZ3VsYXIsXG4gICAgICAgIHNtYWxsOiBwaG90by51cmxzLnNtYWxsLFxuICAgICAgICB0aHVtYm5haWw6IHBob3RvLnVybHMudGh1bWIsXG4gICAgICAgIGFsdDogYCR7cXVlcnl9IHBob3RvIGJ5ICR7cGhvdG8udXNlci5uYW1lfSBjb3VydGVzeSBvZiBVbnNwbGFzaGBcbiAgICAgIH0pXG4gICAgfVxuICAgIFxuICAgIHJlcy5qc29uKHtcIlRvdGFsIFBhZ2VzXCI6IGpzb24udG90YWxfcGFnZXMsIHBob3Rvc30pXG4gICAgdXBkYXRlTGF0ZXN0KHF1ZXJ5LCBvZmZzZXQsIHJlc3VsdHMpXG4gIH0pXG4gIC5jYXRjaChlcnIgPT4ge1xuICAgIGlmIChlcnIuc3RhY2spIHJlcy5qc29uKHtlcnJvcjogZXJyLnN0YWNrfSlcbiAgICBlbHNlIHJlcy5qc29uKHtlcnI6ICdBbiBlcnJvciBvY2N1cmVkLid9KVxuICB9KSAgXG59KVxuXG5hcHAubGlzdGVuKHByb2Nlc3MuZW52LlBPUlQpXG5jb25zb2xlLmxvZyhgbGlzdGVuaW5nIG9uIHBvcnQgJHtwcm9jZXNzLmVudi5QT1JUfS4uLmApIl19",
    "ast": null,
    "map": {
      "version": 3,
      "sources": [
        "app.js"
      ],
      "names": [
        "unsplash",
        "applicationId",
        "process",
        "env",
        "secret",
        "callbackUrl",
        "app",
        "latest",
        "Date",
        "now",
        "updateLatest",
        "query",
        "offset",
        "results",
        "length",
        "shift",
        "push",
        "console",
        "log",
        "use",
        "req",
        "res",
        "next",
        "header",
        "get",
        "send",
        "json",
        "params",
        "photo",
        "search",
        "photos",
        "then",
        "total_pages",
        "error",
        "Error",
        "stack",
        "photographer",
        "user",
        "name",
        "raw",
        "urls",
        "full",
        "regular",
        "small",
        "thumbnail",
        "thumb",
        "alt",
        "catch",
        "err",
        "listen",
        "PORT"
      ],
      "mappings": "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",
      "file": "app.js",
      "sourceRoot": "/app",
      "sourcesContent": [
        "import Express from 'express'\nimport 'isomorphic-fetch'\nimport Unsplash, { toJson } from 'unsplash-js'\n\nconst unsplash = new Unsplash({\n  applicationId: process.env.applicationId,\n  secret: process.env.secret,\n  callbackUrl: process.env.callbackUrl\n})\n\nconst app = Express()\nconst latest = [{'date': Date.now()}]\n\nfunction updateLatest(query, offset, results) {\n  if (latest.length == 10) latest.shift()\n  latest.push({\n    'query': query,\n    'offset': offset,\n    'results': results,\n    'date': Date.now()\n  })\n  console.log(latest)\n}\n\n// enable CORS\napp.use((req, res, next) => {\n  res.header(\"Access-Control-Allow-Origin\", \"*\");\n  res.header(\"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Accept\");\n  next()\n})\n\napp.get('/', (req, res) => {\n  res.send('Need help?</br><a href=\"https://github.com/IsaacAbrahamson/image-abstraction\" target=\"_blank\">Visit Repository</a>')\n})\n\napp.get('/api/latest', (req, res) => res.json(latest))\n\napp.get('/api/search/:photo', (req, res) => {\n  var query = req.params.photo\n  var offset = req.query.offset || 1\n  var results = req.query.results || 5\n  \n  unsplash.search.photos(query, offset, results)\n  .then(toJson)\n  .then(json => {\n    if (offset > json.total_pages) {\n      var error = new Error()\n      error.stack = `Offset (${offset}) exceeds number of pages available (${json.total_pages})`\n      throw error\n    }\n    \n    var photos = []    \n    for (var photo of json.results) {     \n      photos.push({\n        photographer: photo.user.name + ' | Unsplash',\n        raw: photo.urls.raw,\n        full: photo.urls.full,\n        regular: photo.urls.regular,\n        small: photo.urls.small,\n        thumbnail: photo.urls.thumb,\n        alt: `${query} photo by ${photo.user.name} courtesy of Unsplash`\n      })\n    }\n    \n    res.json({\"Total Pages\": json.total_pages, photos})\n    updateLatest(query, offset, results)\n  })\n  .catch(err => {\n    if (err.stack) res.json({error: err.stack})\n    else res.json({err: 'An error occured.'})\n  })  \n})\n\napp.listen(process.env.PORT)\nconsole.log(`listening on port ${process.env.PORT}...`)"
      ]
    },
    "mtime": 1487127561121
  }
}